"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[37],{2037:(e,t,r)=>{r.r(t),r.d(t,{default:()=>o});var n=r(7876),l=r(4232),a=r(2467),s=r(7378);function o(e){let{gameRoomId:t,message:r,playerCount:o,currentSegmentIndex:i,canDrawOrPlaceLine:c,isWaitingForOtherPlayers:u,receivedCanvasImage:d,previousRedLineY:h,isGameOver:g,finalArtwork:x,finalArtwork2:m,currentPlayersWsId:b,wsRef:f,setMessage:w,handlePlayAgain:v,dynamicCanvasWidth:p,dynamicCanvasHeight:k,setCanDrawOrPlaceLine:j,setIsWaitingForOtherPlayers:y}=e,C=(0,l.useRef)(null),N=(0,l.useRef)(null),S=(0,l.useRef)(null),L=(0,l.useRef)(null),[M,R]=(0,l.useState)(!1),[D,P]=(0,l.useState)(0),[A,E]=(0,l.useState)(0),[I,W]=(0,l.useState)(!1),[T,z]=(0,l.useState)(!1),[O,F]=(0,l.useState)(k),B=3===i;(0,l.useEffect)(()=>{let e=C.current,t=S.current;if(!e||!t)return;let r=e.getContext("2d");r.lineCap="round",r.strokeStyle="black",r.lineWidth=5,N.current=r;let n=t.getContext("2d");L.current=n,n.clearRect(0,0,p,k),d||0!==i||r.clearRect(0,0,p,k)},[C,S,d,i,p,k]),(0,l.useEffect)(()=>{if(d&&C.current){let e=new Image;e.onload=()=>{let t=C.current.getContext("2d");t.clearRect(0,0,p,k),t.drawImage(e,0,0)},e.onerror=e=>{console.error("Error loading received canvas image:",e)},e.src=d}else!d&&C.current&&C.current.getContext("2d").clearRect(0,0,p,k)},[d,p,k]);let _=(0,l.useCallback)(e=>{let t=S.current,r=L.current;t&&r&&(r.clearRect(0,0,t.width,t.height),r.strokeStyle="red",r.lineWidth=2,r.beginPath(),r.moveTo(0,e),r.lineTo(t.width,e),r.stroke(),r.closePath())},[]),Y=(0,l.useCallback)(()=>{let e=S.current,t=L.current;e&&t&&t.clearRect(0,0,e.width,e.height)},[]),G=(0,l.useCallback)((e,t)=>{let r,n,l=t.getBoundingClientRect(),a=t.width/l.width,s=t.height/l.height;return e.touches&&e.touches.length>0?(r=e.touches[0].clientX,n=e.touches[0].clientY):(r=e.clientX,n=e.clientY),{x:(r-l.left)*a,y:(n-l.top)*s}},[]),U=(0,l.useCallback)(e=>{if(!c||g)return;e.preventDefault();let t=S.current;if(!t)return;let{x:r,y:n}=G(e,t);if(R(!0),P(r),E(n),!T){if(!N.current)return;N.current.beginPath(),N.current.moveTo(r,n)}},[c,g,T,G]),X=(0,l.useCallback)(e=>{if(!M||!c||g)return;e.preventDefault();let t=S.current;if(!t)return;let{x:r,y:n}=G(e,t);if(T){let e=Math.max(0,Math.min(k,n));F(e),_(e)}else{if(!N.current)return;N.current.lineTo(r,n),N.current.stroke(),W(!0)}P(r),E(n)},[M,c,g,T,_,G,k]),H=(0,l.useCallback)(()=>{c&&!g&&M&&(N.current&&!T&&N.current.closePath(),R(!1))},[c,g,M,T]),J=(0,l.useCallback)(()=>{M&&!T?H():T&&M&&R(!1)},[M,T,H]),q=(0,l.useCallback)(()=>{3!==i&&(R(!1),N.current&&N.current.closePath(),z(!0),F(k/2),_(k/2))},[_,i,k]),K=c&&!u&&!g&&(T||B&&I&&!M);return(0,n.jsxs)("div",{className:"w-full max-w-3xl flex flex-col items-center relative",children:[(0,n.jsx)("p",{className:"message text-xl text-gray-700 font-medium",children:r}),g?(0,n.jsx)(s.default,{finalArtwork:x,finalArtwork2:m,handlePlayAgain:v}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"relative bg-gray-100 rounded-lg shadow-inner border border-gray-200 overflow-hidden",children:[(0,n.jsx)("canvas",{ref:C,width:p,height:k,className:"absolute top-0 left-0 rounded-lg",style:{zIndex:0}}),(0,n.jsx)("div",{className:"absolute top-0 left-0 w-full h-full",style:{width:p,height:k,pointerEvents:"none",zIndex:1},children:d&&i>0&&null!==h&&(0,n.jsx)("div",{className:"absolute top-0 left-0 w-full bg-gray-200 bg-opacity-75 flex items-center justify-center text-gray-600 text-xl font-semibold",style:{height:"".concat(h,"px"),pointerEvents:"none",overflow:"hidden"},children:"Previous Segment Hidden"})}),(0,n.jsx)("canvas",{ref:S,width:p,height:k,onMouseDown:U,onMouseMove:X,onMouseUp:H,onMouseOut:J,onTouchStart:U,onTouchMove:X,onTouchEnd:H,onTouchCancel:H,className:"relative rounded-lg ".concat(c?"cursor-crosshair":"cursor-not-allowed"),style:{zIndex:2}}),u&&(0,n.jsxs)("div",{className:"absolute inset-0 bg-black bg-opacity-70 flex items-center justify-center rounded-lg text-white text-3xl font-bold text-center p-4 z-30",children:["Submitted!",(0,n.jsx)("br",{}),"Waiting for other player to submit their segment..."]})]}),(0,n.jsx)(a.default,{clearCanvas:()=>{let e=C.current,t=N.current;if(e&&t&&(t.clearRect(0,0,p,k),d)){let e=new Image;e.onload=()=>{t.drawImage(e,0,0,p,k)},e.src=d}Y(),z(!1),F(k),W(!1)},isGameOver:g,canDrawOrPlaceLine:c,handleDoneDrawing:q,isLastSegment:B,canSubmitSegment:K,submitSegment:()=>{if(!f.current||f.current.readyState!==WebSocket.OPEN)return void w("WebSocket not connected. Cannot submit.");if(!c||u||g||!T&&!B||!I&&!T)return void w("Cannot submit: Not your turn, game over, or conditions not met.");let e=C.current.toDataURL("image/png");f.current.send(JSON.stringify({type:"submitSegment",gameRoomId:t,canvasData:e,redLineY:B?null:O,playerId:b})),R(!1),y(!0),j(!1),W(!1),z(!1),Y()},isPlacingRedLine:T,isWaitingForOtherPlayers:u,hasDrawnSomething:I,isDrawing:M})]})]})}},2467:(e,t,r)=>{r.r(t),r.d(t,{default:()=>l});var n=r(7876);function l(e){let{clearCanvas:t,isGameOver:r,canDrawOrPlaceLine:l,handleDoneDrawing:a,isLastSegment:s,canSubmitSegment:o,submitSegment:i,isPlacingRedLine:c,isWaitingForOtherPlayers:u,hasDrawnSomething:d,isDrawing:h}=e;return(0,n.jsxs)("div",{className:"game-buttons-container",children:[" ",(0,n.jsxs)("button",{onClick:t,className:"px-2 py-2  text-lg font-bold rounded-lg transition-all duration-300 ease-in-out transform hover:scale-105 flex items-center justify-center\n                                ".concat(l&&!r?"bg-red-500 text-white shadow-lg hover:bg-red-600":"bg-gray-400 cursor-not-allowed shadow-inner"),disabled:!l||r,title:"Clear Canvas",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2.5,stroke:"currentColor",className:"w-7 h-7",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})}),(0,n.jsx)("span",{className:"sr-only",children:"Clear Canvas"})," "]}),!s&&!c&&(0,n.jsxs)("button",{onClick:a,className:"px-2 py-2 text-lg font-bold rounded-lg transition-all duration-300 ease-in-out transform hover:scale-105 flex items-center justify-center\n                                        ".concat(!l||u||r||!d||h?"bg-gray-400 cursor-not-allowed shadow-inner":"bg-blue-600 text-white shadow-lg hover:bg-blue-700"),disabled:!l||u||r||!d||h,title:"Done Drawing",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2.5,stroke:"currentColor",className:"w-7 h-7",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,n.jsx)("span",{className:"sr-only",children:"Done Drawing"})," "]}),(c||s)&&(0,n.jsxs)("button",{onClick:i,className:"px-3 py-3 text-lg font-bold rounded-lg transition-all duration-300 ease-in-out transform hover:scale-105 flex items-center justify-center\n                                        ".concat(o?"bg-green-600 text-white shadow-lg hover:bg-green-700":"bg-gray-400 cursor-not-allowed shadow-inner"),disabled:!o,title:s?"Submit Final Artwork":"Submit Segment",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2.5,stroke:"currentColor",className:"w-7 h-7",children:s?(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}):(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"})}),(0,n.jsx)("span",{className:"sr-only",children:s?"Submit Final Artwork":"Submit Segment"})]})]})}},7378:(e,t,r)=>{r.r(t),r.d(t,{default:()=>l});var n=r(7876);function l(e){let{finalArtwork:t,finalArtwork2:r,handlePlayAgain:l}=e;return(0,n.jsxs)("div",{className:"text-center mt-5",children:[(0,n.jsx)("h2",{className:"text-4xl font-extrabold text-purple-700 my-4 animate-bounce",children:"Game Over!"}),(0,n.jsxs)("div",{className:"flex flex-col items-center space-y-8 mb-8",children:[t&&(0,n.jsx)("img",{src:t,alt:"Final Combined Artwork 1",className:"bg-white max-w-full h-auto border-4 border-purple-500 rounded-xl shadow-2xl block"}),r&&(0,n.jsx)("img",{src:r,alt:"Final Combined Artwork 2",className:"bg-white max-w-full h-auto border-4 border-purple-500 rounded-xl shadow-2xl block"})]}),(0,n.jsx)("button",{onClick:l,className:"px-8 py-4 text-xl font-bold rounded-lg bg-blue-600 text-white shadow-lg hover:bg-blue-700 transition-colors transform hover:scale-105",children:"Play Again"})]})}}}]);